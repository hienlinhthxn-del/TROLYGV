const url = "https://hienlinh1983troligiaovien.vercel.app/?exam=eyJzdWJqZWN0IjoiVG%2FDoW4iLCJncmFkZSI6IjEiLCJxdWVzdGlvbnMiOlt7ImlkIjoicS16bXRlYTQ3aXUiLCJ0eXBlIjoiVHLhuq9jIG5naGnhu4dtIiwiY29udGVudCI6IkPDsyBiYW8gbmhpw6p1IHF14bqjIGLDs25nIHRyb25nIGjDrG5oIHNhdT8iLCJvcHRpb25zIjpbIkEuIDYiLCJCLiA3IiwiQy4gOCIsIkQuIDkiXSwiYW5zd2VyIjoiQi4gNyIsImV4cGxhbmF0aW9uIjoiSOG7jWMgc2luaCBj4bqnbiB0aOG7sWMgaGnhu4duIHRoYW8gdMOhYyDEkeG6v20gY8OhYyB24bqtdCB0aOG7gyB0cm9uZyBow6xuaCDEkeG7gyB4w6FjIMSR4buLbmggc%2BG7kSBsxrDhu6NuZyBjaMOtbmggeMOhYyBsw6AgNy4gKE3hu6ljIMSR4buZIE5o4bqtbiBiaeG6v3QpIiwiaW1hZ2VQcm9tcHQiOiJW4bq9IDcgcXXhuqMgYsOzbmcgYmF5IG3DoHUgc%2BG6r2Mga2jDoWMgbmhhdS4iLCJxdWVzdGlvbiI6IkPDsyBiYW8gbmhpw6p1IHF14bqjIGLDs25nIHRyb25nIGjDrG5oIHNhdT8ifSx7ImlkIjoicS10djkyZHV0ZTEiLCJ0eXBlIjoiVOG7sSBsdeG6rW4iLCJjb250ZW50IjoiU%2BG7kSBsaeG7gW4gc2F1IGPhu6dhIHPhu5EgOCBsw6Agc%2BG7kSBuw6BvPyIsImFuc3dlciI6IjkiLCJleHBsYW5hdGlvbiI6IlPhu5EgbGnhu4FuIHNhdSBj4bunYSBt4buZdCBz4buRIGzDoCBz4buRIGzhu5tuIGjGoW4gc%2BG7kSDEkcOzIDEgxJHGoW4gduG7iy4gVGEgY8OzOiA4ICsgMSA9IDkuIChN4bupYyDEkeG7mSBOaOG6rW4gYmnhur90KSIsImltYWdlUHJvbXB0IjoiIiwicXVlc3Rpb24iOiJT4buRIGxp4buBbiBzYXUgY%2BG7p2Egc%2BG7kSA4IGzDoCBz4buRIG7DoG8%2FIn0seyJpZCI6InEtNTVwdGF4dHI5IiwidHlwZSI6IlThu7EgbHXhuq1uIiwiY29udGVudCI6IlTDrW5oOiAzICsgNCA9IiwiYW5zd2VyIjoiNyIsImV4cGxhbmF0aW9uIjoiSOG7jWMgc2luaCB0aOG7sWMgaGnhu4duIHBow6lwIGPhu5luZyB0cm9uZyBwaOG6oW0gdmkgMTA6IDMgY%2BG7mW5nIDQgYuG6sW5nIDcuIChN4bupYyDEkeG7mSBOaOG6rW4gYmnhur90KSIsImltYWdlUHJvbXB0IjoiIiwicXVlc3Rpb24iOiJUw61uaDogMyArIDQgPSJ9LHsiaWQiOiJxLXNwbGZ4dDJ6ayIsInR5cGUiOiJUcuG6r2MgbmdoaeG7h20iLCJjb250ZW50IjoixJBp4buBbiBk4bqldSAoPiwgPCwgPSkgdGjDrWNoIGjhu6NwIHbDoG8gY2jhu5cgdHLhu5FuZzogMTAgLi4uIDkgKyAxIiwib3B0aW9ucyI6WyJBLiA%2BIiwiQi4gPCIsIkMuID0iLCJELiBLaMO0bmcgY8OzIGThuqV1IG7DoG8gxJHDum5nIl0sImFuc3dlciI6IkMuID0iLCJleHBsYW5hdGlvbiI6IlRyxrDhu5tjIGjhur90IHRhIHTDrW5oIDkgKyAxID0gMTAuIFNhdSDEkcOzIHNvIHPDoW5oIDEwIHbDoCAxMC4gSGFpIHPhu5EgbsOgeSBi4bqxbmcgbmhhdS4gKE3hu6ljIMSR4buZIFRow7RuZyBoaeG7g3UpIiwiaW1hZ2VQcm9tcHQiOiIiLCJxdWVzdGlvbiI6IsSQaeG7gW4gZOG6pXUgKD4sIDwsID0pIHRow61jaCBo4bujcCB2w6BvIGNo4buXIHRy4buRbmc6IDEwIC4uLiA5ICsgMSJ9LHsiaWQiOiJxLXNuNjlvd3UzcyIsInR5cGUiOiJUcuG6r2MgbmdoaeG7h20iLCJjb250ZW50IjoiS%2BG6v3QgcXXhuqMgY%2BG7p2EgcGjDqXAgdMOtbmggMTUgLSA1IGzDoDoiLCJvcHRpb25zIjpbIkEuIDUiLCJCLiAxMCIsIkMuIDE1IiwiRC4gMjAiXSwiYW5zd2VyIjoiQi4gMTAiLCJleHBsYW5hdGlvbiI6Ikjhu41jIHNpbmggdGjhu7FjIGhp4buHbiBwaMOpcCB0cuG7qyAxNSB0cuG7qyA1LiBUYSB0cuG7qyBjaOG7ryBz4buRIGjDoG5nIMSRxqFuIHbhu4s6IDUgLSA1ID0gMDsgZ2nhu68gbmd1ecOqbiBjaOG7ryBz4buRIGjDoG5nIGNo4bulYyBsw6AgMS4gS%2BG6v3QgcXXhuqMgbMOgIDEwLiAoTeG7qWMgxJHhu5kgVGjDtG5nIGhp4buDdSkiLCJpbWFnZVByb21wdCI6IiIsInF1ZXN0aW9uIjoiS%2BG6v3QgcXXhuqMgY%2BG7p2EgcGjDqXAgdMOtbmggMTUgLSA1IGzDoDoifSx7ImlkIjoicS0zN3Z1cnVyOWciLCJ0eXBlIjoiVOG7sSBsdeG6rW4iLCJjb250ZW50IjoiVMOtbmg6IDUgKyAyIC0gNCA9IiwiYW5zd2VyIjoiMyIsImV4cGxhbmF0aW9uIjoiVGjhu7FjIGhp4buHbiBwaMOpcCB0w61uaCB04burIHRyw6FpIHNhbmcgcGjhuqNpOiA1ICsgMiA9IDc7IHNhdSDEkcOzIDcgLSA0ID0gMy4gKE3hu6ljIMSR4buZIFRow7RuZyBoaeG7g3UpIiwiaW1hZ2VQcm9tcHQiOiIiLCJxdWVzdGlvbiI6IlTDrW5oOiA1ICsgMiAtIDQgPSJ9LHsiaWQiOiJxLXhoazg4N282ZyIsInR5cGUiOiJU4buxIGx14bqtbiIsImNvbnRlbnQiOiLEkGnhu4FuIHPhu5EgdGjDrWNoIGjhu6NwIHbDoG8gw7QgdHLhu5FuZzogOSArIFsgXSA9IDEwIiwiYW5zd2VyIjoiMSIsImV4cGxhbmF0aW9uIjoixJDhu4MgdMOsbSBz4buRIGjhuqFuZyBjaMawYSBiaeG6v3QsIHRhIGzhuqV5IHThu5VuZyB0cuG7qyDEkWkgc%2BG7kSBo4bqhbmcgxJHDoyBiaeG6v3Q6IDEwIC0gOSA9IDEuIChN4bupYyDEkeG7mSBUaMO0bmcgaGnhu4N1KSIsImltYWdlUHJvbXB0IjoiIiwicXVlc3Rpb24iOiLEkGnhu4FuIHPhu5EgdGjDrWNoIGjhu6NwIHbDoG8gw7QgdHLhu5FuZzogOSArIFsgXSA9IDEwIn0seyJpZCI6InEtanYzYjQxa3JhIiwidHlwZSI6IlThu7EgbHXhuq1uIiwiY29udGVudCI6IlPhuq9wIHjhur9wIGPDoWMgc%2BG7kSBzYXUgdGhlbyB0aOG7qSB04buxIHThu6sgYsOpIMSR4bq%2FbiBs4bubbjogMTI7IDU7IDIwLiIsImFuc3dlciI6IjU7IDEyOyAyMCIsImV4cGxhbmF0aW9uIjoiSOG7jWMgc2luaCBzbyBzw6FuaCBjw6FjIHPhu5EuIFPhu5EgY8OzIG3hu5l0IGNo4buvIHPhu5EgKDUpIGzDoCBiw6kgbmjhuqV0LiBT4buRIDEyIHbDoCAyMCDEkeG7gXUgbMOgIHPhu5EgY8OzIGhhaSBjaOG7ryBz4buRLCB0YSBzbyBzw6FuaCBjaOG7ryBz4buRIGjDoG5nIGNo4bulYzogMSA8IDIuIFbhuq15IHRo4bupIHThu7EgxJHDum5nIGzDoCA1OyAxMjsgMjAuIChN4bupYyDEkeG7mSBUaMO0bmcgaGnhu4N1KSIsImltYWdlUHJvbXB0IjoiIiwicXVlc3Rpb24iOiJT4bqvcCB44bq%2FcCBjw6FjIHPhu5Egc2F1IHRoZW8gdGjhu6kgdOG7sSB04burIGLDqSDEkeG6v24gbOG7m246IDEyOyA1OyAyMC4ifSx7ImlkIjoicS1nN2EyNXUwc3giLCJ0eXBlIjoiVOG7sSBsdeG6rW4iLCJjb250ZW50IjoiR2nhuqNpIGLDoGkgdG%2FDoW4gc2F1OiBcblRyb25nIHbGsOG7nW4gY8OzIDcgY29uIGfDoC4gQuG7kSBtdWEgdGjDqm0gMyBjb24gZ8OgIG7hu69hLiBI4buPaSB0cm9uZyB2xrDhu51uIGPDsyB04bqldCBj4bqjIGJhbyBuaGnDqnUgY29uIGfDoD8iLCJhbnN3ZXIiOiJM4budaSBnaeG6o2k6XG5T4buRIGfDoCB0cm9uZyB2xrDhu51uIGPDsyB04bqldCBj4bqjIGzDoDpcbjcgKyAzID0gMTAgKGNvbiBnw6ApXG7EkMOhcCBz4buROiAxMCBjb24gZ8OgLiIsImV4cGxhbmF0aW9uIjoixJDDonkgbMOgIGLDoGkgdGjDoW4gJ3Row6ptJy4gxJDhu4MgdMOsbSB04buVbmcgc%2BG7kSBjb24gZ8OgLCB0YSB0aOG7sWMgaGnhu4duIHBow6lwIGPhu5luZyBz4buRIGfDoCBiYW4gxJHhuqd1IHbDoCBz4buRIGfDoCDEkcaw4bujYyB0aMOqbTogNyArIDMgPSAxMC4gKE3hu6ljIMSR4buZIFbhuq1uIGThu6VuZykiLCJpbWFnZVByb21wdCI6IiIsInF1ZXN0aW9uIjoiR2nhuqNpIGLDoGkgdG%2FDoW4gc2F1OiBcblRyb25nIHbGsOG7nW4gY8OzIDcgY29uIGfDoC4gQuG7kSBtdWEgdGjDqm0gMyBjb24gZ8OgIG7hu69hLiBI4buPaSB0cm9uZyB2xrDhu51uIGPDsyB04bqldCBj4bqjIGJhbyBuaGnDqnUgY29uIGfDoD8ifSx7ImlkIjoicS1lbXd4M3ZnZ20iLCJ0eXBlIjoiVOG7sSBsdeG6rW4iLCJjb250ZW50IjoiU%2BG7kSBiw60g4bqpbjogU%2BG7kSDEkcOzIGzDoCBz4buRIGPDsyBoYWkgY2jhu68gc%2BG7kS4gU%2BG7kSDEkcOzIGzhu5tuIGjGoW4gMTAgbmjGsG5nIG5o4buPIGjGoW4gMTUuIENo4buvIHPhu5EgaMOgbmcgxJHGoW4gduG7iyBsw6AgMy4gSOG7j2kgc%2BG7kSDEkcOzIGzDoCBz4buRIG3huqV5PyIsImFuc3dlciI6IjEzIiwiZXhwbGFuYXRpb24iOiJDw6FjIHPhu5EgbOG7m24gaMahbiAxMCB2w6Agbmjhu48gaMahbiAxNSBsw6A6IDExLCAxMiwgMTMsIDE0LiBUcm9uZyBjw6FjIHPhu5EgbsOgeSwgY2jhu4kgY8OzIHPhu5EgMTMgY8OzIGNo4buvIHPhu5EgaMOgbmcgxJHGoW4gduG7iyBsw6AgMy4gKE3hu6ljIMSR4buZIFbhuq1uIGThu6VuZyBjYW8pIiwiaW1hZ2VQcm9tcHQiOiIiLCJxdWVzdGlvbiI6IlPhu5EgYsOtIOG6qW46IFPhu5EgxJHDsyBsw6Agc%2BG7kSBjw7MgaGFpIGNo4buvIHPhu5EuIFPhu5EgxJHDsyBs4bubbiBoxqFuIDEwIG5oxrBuZyBuaOG7jyBoxqFuIDE1LiBDaOG7ryBz4buRIGjDoG5nIMSRxqFuIHbhu4sgbMOgIDMuIEjhu49pIHPhu5EgxJHDsyBsw6Agc%2BG7kSBt4bqleT8ifV19";

const urlParams = new URLSearchParams(url.split('?')[1]);
const sharedExam = urlParams.get('exam');

console.log('Shared exam param:', sharedExam);

try {
    let safeBase64 = sharedExam.replace(/ /g, '+');
    safeBase64 = safeBase64.replace(/[\n\r]/g, '');
    safeBase64 = safeBase64.replace(/-/g, '+').replace(/_/g, '/');

    while (safeBase64.length % 4 !== 0) {
        safeBase64 += '=';
    }

    console.log('Processed Base64:', safeBase64);

    // Use Buffer for base64 decoding in Node.js instead of atob/escape/decodeURIComponent sequence meant for browser
    // But to emulate browser behavior we need to be careful.
    // In Node:
    const buffer = Buffer.from(safeBase64, 'base64');
    const decoded = buffer.toString('utf-8');

    console.log('Decoded JSON:', decoded);

    const data = JSON.parse(decoded);
    console.log('Parsed Data:', data);

} catch (e) {
    console.error('Error:', e);
}
